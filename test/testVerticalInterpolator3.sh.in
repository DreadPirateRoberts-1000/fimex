#! /bin/sh
echo "testing interpolation to altitude"
OUT_NC="out$$.nc"
../src/binSrc/fimex \
    --verticalInterpolate.type=altitude \
    --verticalInterpolate.level1=800,400,100,50 \
    --verticalInterpolate.method=linear_const_extra \
    --input.file=@top_srcdir@/test/testdata_altitude_height_in.nc \
    --output.file="$OUT_NC" --output.type=nc4
if [ $? != 0 ]; then
  echo "failed interpolation to altitude"
  rm -f "$OUT_NC"
  exit 1
fi

EXP_NC="@top_srcdir@/test/testdata_altitude_height_ex.nc"
if "@srcdir@/nccmp.sh" "$EXP_NC" "$OUT_NC" ; then
  echo "success"
  E=0
else
  echo "failed diff interpolation to altitude"
  E=1
fi
rm -f "$OUT_NC"
exit $E
